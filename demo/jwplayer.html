<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>CDNBye JWPlayer Demo</title>
    <!-- P2PEngine -->
    <script src="https://cdn.jsdelivr.net/npm/swarmcloud-hls@latest/dist/p2p-engine.min.js"></script>
    <!-- JW Player Builds -->
    <script src="//ssl.p.jwpcdn.com/player/v/8.30.0/jwplayer.js"></script>
</head>
<body>
<header></header>
<center>
    <div id="demoplayer"></div>
</center>
<script>
    var p2pConfig = {
        logLevel: 'debug',
        live: false,        // set to true in live mode
        swFile: './sw.js',
        // trackerZone: 'hk',        // if using Hongkong tracker
        // trackerZone: 'us',        // if using USA tracker
        // token: YOUR_TOKEN
        // Other p2pConfig options provided by CDNBye
    }
    const isSamsungBrowser = navigator.userAgent.indexOf('SamsungBrowser') > - 1;
    if (!isSamsungBrowser && !P2pEngineHls.isMSESupported() || P2pEngineHls.getBrowser() === 'Mac-Safari') {
        // use ServiceWorker based p2p engine, need additional file sw.js
        new P2pEngineHls.ServiceWorkerEngine(p2pConfig)
    }
    jwplayer.key = "uoW6qHjBL3KNudxKVnwa3rt5LlTakbko9e6aQ6VUyKQ=";
    var player = jwplayer('demoplayer').setup({
        file: 'https://test-streams.mux.dev/x36xhzz/url_2/193039199_mp4_h264_aac_ld_7.m3u8',
        width: 512,
        height: 288,
        hlsjsdefault: true,
        hlsjsConfig: {
            liveSyncDurationCount: 3,
            // debug: true,
            // Other hlsjsConfig options provided by hls.js
            p2pConfig
        },
    });
    player.on('ready', () => {
        if (P2PEngineHls.isMSESupported()) {
            new P2PEngineHls({
                hlsjsInstance: player.hls,
                ...p2pConfig
            });
        }
    })
    P2PEngineHls.tryRegisterServiceWorker(p2pConfig).then(() => {
        player.play();
    })
</script>
</body>
</html>
